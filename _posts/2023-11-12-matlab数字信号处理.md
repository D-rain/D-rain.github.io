---
title: matlab数字信号处理
subtitle: matlab数字信号处理 FIR IIR滤波器设计
date: 2023-10-19
author: rain
header-img: img/post-bg-article.jpg
tags:
  - 数字信号处理
---

# 滤波器介绍
常用的数字滤波器：FIR	IIR
## FIR滤波器（有限脉冲响应滤波器）：
### 特点：
1、FIR滤波器的脉冲响应是有限的，因此称为有限脉冲响应滤波器。
2、不包含递归（反馈）部分，只使用前向路径。
3、系统函数（传递函数）是一个多项式，因此没有极点。
### 优点：

1、稳定性：FIR滤波器总是稳定的，因为没有递归反馈。
2、设计灵活性：可以设计为线性相位，因此不会引入信号的相位失真。
3、相对简单：在实现上通常比IIR滤波器简单。
### 缺点：
1、阶数较高时可能需要更多的计算资源。
2、对于某些应用，可能需要较高的阶数以获得所需的性能。
## IIR滤波器（无限脉冲响应滤波器）：
### 特点：

1、IIR滤波器的脉冲响应是无限的，因此称为无限脉冲响应滤波器。
2、包含递归（反馈）部分，因此在系统的输出中包含前一时刻的输出。
### 优点：
1、阶数相对较低时，可以实现与FIR滤波器相当的性能。
2、在一些应用中，IIR滤波器能够以更低的阶数实现所需的频率响应。
### 缺点：
1、稳定性：IIR滤波器的稳定性受到极点位置的影响，需要确保所有极点都在单位圆内。
2、相位失真：由于反馈路径，IIR滤波器可能引入信号的相位失真。
3、设计复杂性：设计IIR滤波器可能更加复杂，需要考虑极点和零点的位置。
###  选择：
选择FIR还是IIR取决于应用的具体要求和性能需求。在一些应用中，FIR滤波器的线性相位特性和稳定性可能更为重要，而在一些其他应用中，IIR滤波器可能以更低的阶数实现相似的性能。
FIR滤波器通常用于需要线性相位响应和稳定性的应用，如音频均衡、信号去噪等。
IIR滤波器通常用于对系统的实时响应要求较高的应用，如通信系统、控制系统等。

### IIR滤波器：
差分方程:$y[i]=\sum_{(j=0)}^{(N-1)}[h[j]*x][i-j]$（N;滤波器阶数）（差分方程：描述系统输出与输入之间的关系
也就是说`通过滤波器设计软件设计出系数h[j]`即可以通过数字滤波完成滤波操作
`滤波器系数：`决定了滤波器的性能，频率响应、截止频率等  
`系数设计方法：`
窗函数法： 窗函数法是一种直观且常用的FIR滤波器设计方法。在这种方法中，首先选择一个窗函数（如矩形窗、汉宁窗、汉明窗等），然后将窗函数与所需的频率响应进行卷积，最终得到滤波器系数。矩形窗的使用通常会导致频谱泄漏，而其他窗函数可以改善这一问题。

最小二乘法： 最小二乘法的目标是最小化滤波器的输出与期望响应之间的均方误差。通过数学优化方法，可以得到最小二乘法的系数。这种方法通常能够更好地满足特定的频率响应要求。
### C语言实现：
``` c
#include <stdio.h>
#include <stdlib.h>

#define N 3 // 滤波器的阶数

// FIR滤波器系数
double h[N] = {0.1, 0.2, 0.3};

// 输入信号
double x[100] = { /* 输入信号的数据点 */ };

// 输出信号
double y[100] = {0.0};

// FIR滤波函数
void fir_filter(double *x, double *h, double *y, int signal_length, int filter_length) 
{
    int i, j;
    
    for (i = 0; i < signal_length; ++i) 
    {
        printf("y[%d] = ",i);
        for (j = 0; j < filter_length; ++j) 
        {
            if (i - j >= 0) 
            {
                y[i] += x[i - j] * h[j];
                //printf("x[%d ] * h[%d]+",i-j,j);
            }
           
        }
        printf("\r\n"); 
    }
}

int main() {
    // 计算输出信号
    fir_filter(x, h, y, 100, N);

    int i = 0; 
    // 打印输出信号
    printf("Filtered signal:\n");
    for (i = 0; i < 100; ++i) 
    {
         printf("%f ", y[i]);
        //print(y[i]*h[i])
    }

    return 0;
}

```
### Matlab 仿真设计
``` c

%%  生成500Hz方波测试信号
fs = 44100;  % 采样频率
t = 0:1/fs:1-1/fs;  % 时间轴，持续1秒

f_signal = 500;  % 方波信号频率为500Hz
y = square(2 * pi * f_signal * t);  % 生成500Hz方波信号

% 画出方波信号的时域波形和频谱图
n = length(y);  % 获取信号的长度

y_p = fft(y, n);  % 对信号进行傅里叶变换

f = fs * (0:(n/2)-1) / n;  % 计算对应的频率
%FIR 500HZ滤波测试
figure(1)
subplot(2,1,1);
plot(t, y);
title('500Hz方波信号的时域波形');
xlabel('时间 (秒)');
ylabel('幅值 A');
subplot(2,1,2);
plot(f, abs(y_p(1:n/2)));
title('500Hz方波信号的频谱图');
xlabel('频率 (Hz)');


%FIR滤波器设计
filter_length = 30;      %滤波器阶数
cutoff_freq = 300;  % 截止频率为300Hz
y_out = zeros(1,n) % 初始化输出信号
h = fir1(filter_length-1, cutoff_freq/(fs/2));  % 设计低通滤波器系数
%FIR滤波
for i = 1:n 
    for j = 1:filter_length 
        if (i - j >= 1) 
            y_out(i) = y_out(i) + y(i - j+1) * h(j);
        end
    end
end
figure(2)
subplot(2,1,1);
plot(y_out);
title('500Hz方波信号滤波后的时域波形');
xlabel('时间 (秒)');
ylabel('幅值 A');

subplot(2,1,2);
y_out_t = abs(fft(y_out));
plot(f,y_out_t(1:n/2));     %10K信号滤波后的频谱图
title('500Hz方波信号滤波后的频域波形');
xlabel('频率 (Hz)');
```
### 滤波效果
![alt text](/img/blog/5-15-1.png)
![alt text](/img/blog/5-15-2.png)
可以看到方波的三次谐波以下全部滤掉了 效果还是比较好的
设定的截至频率是300Hz的 还是有点高了 衰减效果不是很理想.